version: "3.5"

services:
  # ───────────────── Cassandra ─────────────────
  cassandra:
    image: cassandra:3.11          # recommended by Temporal examples :contentReference[oaicite:1]{index=1}
    logging:
      driver: "none"
    # ports:
    #   - "9042:9042"              # uncomment if you need CQL

  # ───────────── Temporal Server (auto-setup) ─────────────
  temporal-dev:
    image: temporalio/auto-setup:1.22.0   # all four server services + schema init :contentReference[oaicite:2]{index=2}
    ports:
      - "7233:7233"        # gRPC frontend
      - "7234:7234"        # membership ring
    environment:
      - CASSANDRA_SEEDS=cassandra
      - DYNAMIC_CONFIG_FILE_PATH=/etc/dynamic-config.yaml
    volumes:
      - ../../etc/dynamic-config.yaml:/etc/dynamic-config.yaml:ro
    depends_on:
      - cassandra

  # ───────────── Temporal Web-UI (v2) ─────────────
  temporal-web:
    image: temporalio/ui:2.8.0            # UI v2 → port 8080, /healthz :contentReference[oaicite:3]{index=3}
    logging:
      driver: "none"
    ports:
      - "8080:8080"                       # http://localhost:8080
    environment:
      - TEMPORAL_ADDRESS=temporal-dev:7233
      - TEMPORAL_CORS_ORIGINS=http://localhost:3000
    depends_on:
      - temporal-dev
